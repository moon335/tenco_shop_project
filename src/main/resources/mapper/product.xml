<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.tenco.tencoshop.repository.interfaces.ProductRepository">
	<select id="findAll"
		resultType="com.tenco.tencoshop.dto.ProductResponseDto">
		select p.id, p.eng_name, p.kor_name, p.release_price,
		p.img_route, b.name as
		brand_name
		from product_tb as p
		inner join
		brand_tb as b
		on p.brand_id = b.id
		limit 8;
	</select>
	<select id="findProductAll"
		resultType="com.tenco.tencoshop.repository.model.Product">
		select * from product_tb
	</select>
	<select id="findProduct"
		resultType="com.tenco.tencoshop.repository.model.Product">
		select * from product_tb where kor_name LIKE #{title} OR
		eng_name LIKE
		#{title}
	</select>

	<select id="getProdInfo"
		resultType="com.tenco.tencoshop.repository.model.Product">
		select * from product_tb where id = #{id}
	</select>

	<select id="CategorySelect"
		resultType="com.tenco.tencoshop.dto.ProductResponseDto">
		select *
		from product_tb as p
		join category_tb as c
		on
		p.category_id = c.id
		where c.name like #{name};
	</select>

   
   <select id="findProductById" resultType="com.tenco.tencoshop.dto.ProductResponseDtoForReview">
      select p.*, b.name as brand_name, c.name as category_name, s.name as size_name
      from product_tb as p
      inner join brand_tb as b
      on p.brand_id = b.id
      inner join category_tb as c
      on p.category_id = c.id
      inner join size_tb as s
      on p.size_id = s.id
      where p.id = #{id}
   </select>
   
   <select id="findProductByProdId" resultType="com.tenco.tencoshop.dto.ProductResponseDto">
   		select p.*, b.name as brand_name, c.name as category_name, s.name as size_name
	    from product_tb as p
	    inner join brand_tb as b
	    on p.brand_id = b.id
	    inner join category_tb as c
	    on p.category_id = c.id
	    inner join size_tb as s
	    on p.size_id = s.id
	    where p.id = #{id}
   </select>
   
   <select id="findProductByModelNumberAndSize" resultType="com.tenco.tencoshop.dto.ProductResponseDto">
      select p.*, s.name as size_name
      from product_tb as p
      inner join size_tb as s
      on p.size_id = s.id
      where p.model_number = #{modelNumber} and s.name = #{sizeName}
   </select>
   
</mapper>